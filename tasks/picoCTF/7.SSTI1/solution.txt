так в задании дан сайт с полем ввода где придлагается написать обьявление любое (типо заголовок)
первая идея js иньекции проверил через <script>alert(1)</script>
алерт появился значит поле ввода не защищено но пока не ясно как именно достать флаг
в подсказке написано что нужно сделать какуюто иньекцию на стороне сервера
посмотрел запрос через инструмент браузера
посути я именно что отправляю текст на сервер и возвращается строка
возможно надо что то типо <script>alert(flag)</script>
с идеей что в запросе будет переменная в которую записан флаг на сервере и он ее подставит в ответ с сервера
все оказалось не так ну почти
вообщем есть тип уязвимостей server side template injection идея как раз та написать что то типо ....flag и чтобы сервер сам подставил флаг
проверяются они подобными импутами {{7*7}} в таком варианте если сервер не имеет защиту он просто выполнит код внутри скобок и вернет его
конечно все еще вопрос большой как узнать где храниться флаг но на сайтах с примерами имеет место подобный инпут
{{data.username}} возможно надо поиграться с подобными импутами
так же из плюсов когда запрос выдает ошибку ее видно мне значит есть от чего отталкиваться
жаль что больше нет никаких намеков кроме этой ssti
жесть задание вроде в категории easy но на деле нужно очень хорошо понимать что происходит я так на 60% понимаю
вообщем благодаря этой уязвимости можно выводить всякую информацию типо {{self}} где выводятся все методы что есть у self
и там путем какого то подбора методов(я вот в этом не силен) мы получаем это
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}}
как я понял _TemplateReference__context.cycler вот тут я почти не понял как и почему это
но вероятно это около стандартного пути до init у которого мы уже применяли функцию globals чтобы взаимодействовать с глобальными методами
там выводятся все методы и если там есть os то мы можем через метод popen использовать консольные команды ну а там уже дело за малым
написать ls и cat flag
